"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2337],{2337:(T,k,r)=>{r.r(k),r.d(k,{WrongReceiptPageModule:()=>j});var m=r(2200),d=r(4341),a=r(9893),b=r(8132),h=r(467),t=r(3664),l=r(2615),p=r(4030);function f(i,s){if(1&i){const c=t.RV6();t.j41(0,"ion-item",10),t.bIt("click",function(){const n=l.eBV(c).$implicit,e=t.XpG(2);return l.Njj(e.selectBook(n))}),t.j41(1,"ion-label"),t.EFF(2),t.k0s()()}if(2&i){const c=s.$implicit;t.R7$(2),t.JRh(c.item_name)}}function C(i,s){if(1&i){const c=t.RV6();t.j41(0,"ion-list",8),t.bIt("scroll",function(n){l.eBV(c);const e=t.XpG();return l.Njj(e.load_more(n))}),t.DNE(1,f,3,1,"ion-item",9),t.k0s()}if(2&i){const c=t.XpG();t.R7$(),t.Y8G("ngForOf",c.wrong_book_list)}}function P(i,s){1&i&&(t.j41(0,"div",11)(1,"p"),t.EFF(2,"No Books Found"),t.k0s()())}let M=(()=>{var i;class s{constructor(o,n){this.db=o,this.modalCntrl=n,this.wrong_book_list=[],this.page_no=1,this.no_products=!1,this.search_book=""}ngOnInit(){this.getBookList()}getBookList(){let o={page:this.page_no,page_size:20};this.search_book&&(o.search=this.search_book),this.db.get_all_book_list(o).subscribe(n=>{n&&n.message&&"success"==n.message.status&&n.message.data&&n.message.data.items&&n.message.data.items.length>0?this.wrong_book_list=1==this.page_no?n.message.data.items:[...this.wrong_book_list,...n.message.data.items]:(this.no_products=!0,1==this.page_no&&(this.wrong_book_list=[]))})}selectBook(o){this.modalCntrl.dismiss({book_name:o.item_name})}handleInput(o){this.search_book=o.target.value,this.page_no=1,this.getBookList()}load_more(o){if(!this.no_products){let n=o.target.offsetHeight+o.target.scrollTop+1;n=n.toFixed(),n>=o.target.scrollHeight&&(this.page_no+=1,this.getBookList())}}static#t=i=()=>(this.\u0275fac=function(n){return new(n||s)(t.rXU(p.Db),t.rXU(a.W3))},this.\u0275cmp=t.VBU({type:s,selectors:[["app-book-list"]],standalone:!1,decls:11,vars:2,consts:[["mode","md"],["color","primary"],["slot","end"],["fill","clear",3,"click"],["name","close"],["mode","ios",3,"ionInput"],["lines","full",3,"scroll",4,"ngIf"],["class","no_data",4,"ngIf"],["lines","full",3,"scroll"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"no_data"]],template:function(n,e){1&n&&(t.j41(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-title"),t.EFF(3,"Book List"),t.k0s(),t.j41(4,"ion-buttons",2)(5,"ion-button",3),t.bIt("click",function(){return e.modalCntrl.dismiss()}),t.nrm(6,"ion-icon",4),t.k0s()()()(),t.j41(7,"ion-content")(8,"ion-searchbar",5),t.bIt("ionInput",function(_){return e.handleInput(_)}),t.k0s(),t.DNE(9,C,2,1,"ion-list",6)(10,P,3,0,"div",7),t.k0s()),2&n&&(t.R7$(9),t.Y8G("ngIf",e.wrong_book_list&&e.wrong_book_list.length>0),t.R7$(),t.Y8G("ngIf",e.no_products&&e.wrong_book_list&&0==e.wrong_book_list.length))},dependencies:[m.Sq,m.bT,a.Jm,a.QW,a.W9,a.eU,a.iq,a.uz,a.he,a.nf,a.S1,a.BC,a.ai,a.Gw],styles:["ion-list[_ngcontent-%COMP%]{padding:0;height:calc(100vh - 305px);overflow:auto}.no_data[_ngcontent-%COMP%]{text-align:center;margin-top:20px;color:gray;font-size:16px;font-weight:500}"]}))}return i(),s})();var u=r(1562),v=r(5032),O=r(385);function y(i,s){if(1&i){const c=t.RV6();t.j41(0,"div",17)(1,"div")(2,"p",18),t.EFF(3),t.k0s(),t.j41(4,"p",19),t.EFF(5),t.k0s()(),t.j41(6,"ion-icon",20),t.bIt("click",function(){const n=l.eBV(c).index,e=t.XpG(2);return l.Njj(e.remove_book(n))}),t.k0s()()}if(2&i){const c=s.$implicit;t.R7$(3),t.JRh(c.book_name),t.R7$(2),t.SpI("Qty: ",c.qty)}}function B(i,s){if(1&i&&(t.j41(0,"div",15)(1,"h5",4),t.EFF(2,"Books in Wrong Transfer Report"),t.k0s(),t.DNE(3,y,7,2,"div",16),t.k0s()),2&i){const c=t.XpG();t.R7$(3),t.Y8G("ngForOf",c.saved_books)}}function R(i,s){if(1&i){const c=t.RV6();t.j41(0,"div",10)(1,"ion-button",11),t.bIt("click",function(){l.eBV(c);const n=t.XpG();return l.Njj(n.saveWrongBook())}),t.nrm(2,"ion-icon",21),t.EFF(3,"Submit Report"),t.k0s()()}}const F=[{path:"",component:(()=>{var i;class s{constructor(o,n,e,g,_){this.route=o,this.db=n,this.modalCntrl=e,this.nav=g,this.router=_,this.selected_book="Select Book",this.saved_books=[],this.wrong_book_list=[]}ngOnInit(){this.route.params.subscribe(o=>{if(o&&o.id){this.router_name=o.id;const n=localStorage.wrong_books?localStorage.wrong_books:"[]";this.saved_books=JSON.parse(n),localStorage.removeItem("wrong_books")}})}ionViewWillLeave(){this.saved_books.length>0&&(localStorage.setItem("wrong_books",JSON.stringify(this.saved_books)),this.saved_books=[])}saveSelectBook(){if(!this.selected_book_name)return void this.db.presentToast("Please select book","error");if(!this.quantity)return void this.db.presentToast("Please add quantity for book","error");let o={book_name:this.selected_book_name,qty:this.quantity};if(this.findBook(this.selected_book_name)){for(let e=0;e<this.saved_books.length;e++)if(this.saved_books[e].book_name===this.selected_book_name){this.saved_books[e].qty=this.quantity;break}}else this.saved_books.push(o);this.selected_book=null,this.selected_book_name=null,this.quantity=null}remove_book(o){this.saved_books.splice(o,1)}saveWrongBook(){this.db.submit_books_report({stock_entry_name:this.router_name,wrong_books_data:this.saved_books}).subscribe(n=>{n&&n.message&&"success"==n.message.status&&(this.db.presentToast(n.message.message,"success"),this.router.navigateByUrl("/transfer-receipt/"+this.router_name),this.saved_books=[],localStorage.removeItem("wrong_books"))})}openBookList(){var o=this;return(0,h.A)(function*(){const n=yield o.modalCntrl.create({component:M,cssClass:"catalog-filter"});yield n.present();const{data:e}=yield n.onDidDismiss();if(console.log(e,"selected book data"),e&&e.book_name){o.selected_book_name=e.book_name;const g=o.findBook(e.book_name);g?o.quantity=g.qty:o.selected_book=e.book_name}})()}findBook(o){return this.saved_books.find(n=>n.book_name===o)}static#t=i=()=>(this.\u0275fac=function(n){return new(n||s)(t.rXU(u.nX),t.rXU(p.Db),t.rXU(a.W3),t.rXU(v.q9),t.rXU(u.Ix))},this.\u0275cmp=t.VBU({type:s,selectors:[["app-wrong-receipt"]],standalone:!1,decls:21,vars:7,consts:[[3,"home","title"],[2,"--background","#f6f7f9",3,"fullscreen"],[1,"main_section"],[1,"books"],[1,"m-0","title"],[1,"inputs_sec"],[1,"book_name_input"],["placeholder","Select Book","readonly","",3,"click","ngModelChange","ngModel"],[1,"quantity"],["type","number","placeholder","Quantity",3,"ngModelChange","ngModel"],[1,"save_btn"],["fill","clear",3,"click"],["name","add-outline",1,"white"],["class","saved_books",4,"ngIf"],["class","save_btn",4,"ngIf"],[1,"saved_books"],["class","books_",4,"ngFor","ngForOf"],[1,"books_"],[1,"m-0","book"],[1,"m-0","quantity"],["name","close-outline",3,"click"],["name","checkmark-circle-outline",1,"white"]],template:function(n,e){1&n&&(t.nrm(0,"app-header",0),t.j41(1,"ion-content",1)(2,"div",2)(3,"div",3)(4,"h5",4),t.EFF(5,"Select Wrong Books Received"),t.k0s(),t.j41(6,"div",5)(7,"div",6)(8,"label"),t.EFF(9,"Select Book"),t.k0s(),t.j41(10,"input",7),t.bIt("click",function(){return e.openBookList()}),t.mxI("ngModelChange",function(_){return t.DH7(e.selected_book_name,_)||(e.selected_book_name=_),_}),t.k0s()(),t.j41(11,"div",8)(12,"label"),t.EFF(13,"Quantity"),t.k0s(),t.j41(14,"input",9),t.mxI("ngModelChange",function(_){return t.DH7(e.quantity,_)||(e.quantity=_),_}),t.k0s()()(),t.j41(15,"div",10)(16,"ion-button",11),t.bIt("click",function(){return e.saveSelectBook()}),t.nrm(17,"ion-icon",12),t.EFF(18,"Add Book to Report"),t.k0s()()(),t.DNE(19,B,4,1,"div",13)(20,R,4,0,"div",14),t.k0s()()),2&n&&(t.Y8G("home",!1)("title","Wrong Receipt"),t.R7$(),t.Y8G("fullscreen",!0),t.R7$(9),t.R50("ngModel",e.selected_book_name),t.R7$(4),t.R50("ngModel",e.quantity),t.R7$(5),t.Y8G("ngIf",e.saved_books&&e.saved_books.length>0),t.R7$(),t.Y8G("ngIf",e.saved_books&&e.saved_books.length>0))},dependencies:[m.Sq,m.bT,d.me,d.Q0,d.BC,d.vS,a.Jm,a.W9,a.iq,O.l],styles:[".main_section[_ngcontent-%COMP%]{padding:1rem}.main_section[_ngcontent-%COMP%]   .books[_ngcontent-%COMP%]{padding:.75rem;background:#fff;border-radius:10px}.main_section[_ngcontent-%COMP%]   .books[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:15px;font-weight:500;margin-bottom:10px}.main_section[_ngcontent-%COMP%]   .books[_ngcontent-%COMP%]   .book_name_input[_ngcontent-%COMP%]{margin-bottom:.75rem}.main_section[_ngcontent-%COMP%]   .books[_ngcontent-%COMP%]   .book_name_input[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#6b7280;font-weight:600;font-size:.75rem;line-height:1rem}.main_section[_ngcontent-%COMP%]   .books[_ngcontent-%COMP%]   .book_name_input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:.5rem .75rem;background-color:#f0f2f4;margin-top:.25rem;border-radius:.75rem;border:unset!important;font-size:14px}.main_section[_ngcontent-%COMP%]   .books[_ngcontent-%COMP%]   .book_name_input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:1px solid var(--primary-color)}.main_section[_ngcontent-%COMP%]   .books[_ngcontent-%COMP%]   .book_name_input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.5rem .75rem;background-color:#f0f2f4;margin-top:.25rem;border-radius:.75rem;border:unset!important;font-size:14px}.main_section[_ngcontent-%COMP%]   .books[_ngcontent-%COMP%]   .book_name_input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:1px solid var(--primary-color)}.main_section[_ngcontent-%COMP%]   .books[_ngcontent-%COMP%]   .quantity[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#6b7280;font-weight:600;font-size:.75rem;line-height:1rem}.main_section[_ngcontent-%COMP%]   .books[_ngcontent-%COMP%]   .quantity[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.5rem .75rem;background-color:#f0f2f4;margin-top:.25rem;border-radius:.75rem;border:unset!important;font-size:14px}.main_section[_ngcontent-%COMP%]   .books[_ngcontent-%COMP%]   .quantity[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:1px solid var(--primary-color)}.main_section[_ngcontent-%COMP%]   .books[_ngcontent-%COMP%]   .save_btn[_ngcontent-%COMP%]{margin-top:1rem}.main_section[_ngcontent-%COMP%]   .books[_ngcontent-%COMP%]   .save_btn[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--padding-start: 2rem;--padding-end: 2rem;--padding-top: .75rem;--padding-bottom: .75rem;width:100%;font-size:.875rem;line-height:1.25rem;font-weight:600;--border-radius: calc(.75rem - 2px) }.main_section[_ngcontent-%COMP%]   .books[_ngcontent-%COMP%]   .save_btn[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:1rem}.main_section[_ngcontent-%COMP%]   .saved_books[_ngcontent-%COMP%]{margin-top:1rem}.main_section[_ngcontent-%COMP%]   .saved_books[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:15px;font-weight:500;margin-bottom:.75rem}.main_section[_ngcontent-%COMP%]   .saved_books[_ngcontent-%COMP%]   .books_[_ngcontent-%COMP%]{padding:.75rem;background:#fff;display:flex;align-items:center;justify-content:space-between;border-radius:10px;margin-bottom:10px}.main_section[_ngcontent-%COMP%]   .saved_books[_ngcontent-%COMP%]   .books_[_ngcontent-%COMP%]   .book[_ngcontent-%COMP%]{font-size:14px;font-weight:500;margin-bottom:.25rem}.main_section[_ngcontent-%COMP%]   .saved_books[_ngcontent-%COMP%]   .books_[_ngcontent-%COMP%]   .quantity[_ngcontent-%COMP%]{font-size:.75rem;line-height:1rem;padding:.125rem .625rem;background-color:#f0f2f4;border-radius:9999px;display:inline-flex;align-items:center}.main_section[_ngcontent-%COMP%]   .saved_books[_ngcontent-%COMP%]   .books_[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:red}.save_btn[_ngcontent-%COMP%]{padding:.75rem}.save_btn[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--padding-start: 2rem;--padding-end: 2rem;--padding-top: .75rem;--padding-bottom: .75rem;width:100%;font-size:.875rem;line-height:1.25rem;font-weight:600;--border-radius: calc(.75rem - 2px) }.save_btn[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:1rem}"]}))}return i(),s})()}];let I=(()=>{var i;class s{static#t=i=()=>(this.\u0275fac=function(n){return new(n||s)},this.\u0275mod=t.$C({type:s}),this.\u0275inj=l.G2t({imports:[b.iI.forChild(F),b.iI]}))}return i(),s})();var w=r(5553);let j=(()=>{var i;class s{static#t=i=()=>(this.\u0275fac=function(n){return new(n||s)},this.\u0275mod=t.$C({type:s}),this.\u0275inj=l.G2t({imports:[m.MD,d.YN,a.bv,I,w.h]}))}return i(),s})()}}]);