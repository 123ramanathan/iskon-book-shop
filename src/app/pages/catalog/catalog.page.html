<app-header
  [home]="false"
  [title]="'Catalog'"
  [backRoute]="'/tabs/sales'"
></app-header>

<ion-content [fullscreen]="true">
  <main class="section">
    <section class="section__group">
      <div class="section__input">
        <input
          class="section__input-field"
          [(ngModel)]="searchTxt"
          placeholder="Search here..."
          (input)="onSearchChange($event)"
          clearInput
        />

        <svg
          class="section__input-icon"
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <circle cx="11" cy="11" r="8"></circle>
          <path d="m21 21-4.3-4.3"></path>
        </svg>
      </div>

      <div class="section__filters">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="lucide lucide-filter h-4 w-4 text-muted-foreground flex-shrink-0"
        >
          <polygon
            points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"
          ></polygon>
        </svg>

        <!-- <button
          type="button"
          role="combobox"
          aria-controls="radix-:r0:"
          aria-expanded="false"
          aria-autocomplete="none"
          dir="ltr"
          data-state="closed"
          class="section__filters__btn"
        >
          <span style="pointer-events: none">All Categories</span>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="lucide lucide-chevron-down h-4 w-4 opacity-50"
            aria-hidden="true"
          >
            <path d="m6 9 6 6 6-6"></path>
          </svg>
        </button> -->
        <div class="select-wrapper">
          <select
            class="select"
            name="categories"
            [(ngModel)]="category"
            (change)="categoryChange($event)"
          >
            <option *ngFor="let item of categories" [value]="item.name">
              {{ item.name }}
            </option>
          </select>
        </div>
      </div>
    </section>

    <section class="section__body">
      <app-catalog-cards *ngIf="catalog && catalog.length > 0" [catalog]="catalog"></app-catalog-cards>
      
      <ion-infinite-scroll (ionInfinite)="loadMore($event)" threshold="100px">
        <ion-infinite-scroll-content
          loadingText="Loading more..."
          loadingSpinner="bubbles">
        </ion-infinite-scroll-content>
      </ion-infinite-scroll>

    </section>

    <div class="cart-container" *ngIf="db.cartItems.length > 0">
      <ion-button routerLink="/cart" class="cart-button">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="cart-icon"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
          stroke-width="2"
        >
          <circle cx="8" cy="21" r="1"></circle>
          <circle cx="19" cy="21" r="1"></circle>
          <path
            d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"
          ></path>
        </svg>
        View Cart ({{ db.cartItems.length }} items)
      </ion-button>
    </div>
  </main>
</ion-content>
