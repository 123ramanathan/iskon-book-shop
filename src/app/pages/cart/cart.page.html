<app-header [home]="false" [title]="'Cart'"></app-header>

<ion-content [fullscreen]="true">
  <main class="cart">
    <section class="cart__container">
      <div
        class="cart__wrapper"
        *ngIf="db.cartItems && db.cartItems.length > 0"
      >
        <div *ngFor="let item of db.cartItems" class="cart-item">
          <div class="cart-item__content">
            <div class="cart-item__header">
              <div class="cart-item__info">
                <h3 class="cart-item__title">{{ item.item_name }}</h3>
                <p class="cart-item__author">{{ item.author_name }}</p>
                <p class="cart-item__price">
                  {{ db.formatCurrency(item.price_list_rate) }} each
                </p>
              </div>
              <button class="cart-item__delete" (click)="openDeleteModal(item)">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M3 6h18"></path>
                  <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path>
                  <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path>
                  <line x1="10" x2="10" y1="11" y2="17"></line>
                  <line x1="14" x2="14" y1="11" y2="17"></line>
                </svg>
              </button>
            </div>

            <div class="cart-item__quantity">
              <span class="cart-item__label">Qty:</span>
              <div class="cart-item__qty-control">
                <button
                  (click)="db.update_qty(item,'dec')"
                  [disabled]="item.qty <= 1"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="icon"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path d="M5 12h14"></path>
                  </svg>
                </button>
                <span class="cart-item__qty">{{ item.qty }}</span>
                <button (click)="db.update_qty(item,'inc')">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="icon"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path d="M5 12h14"></path>
                    <path d="M12 5v14"></path>
                  </svg>
                </button>
              </div>
            </div>

            <div class="cart-item__subtotal">
              <span class="cart-item__label">Subtotal:</span>
              <span class="cart-item__value"
                >{{ db.formatCurrency(item.qty*(item.price_list_rate ??
                0))}}</span
              >
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- *ngIf="db.subtotal && db.subtotal > 0" -->
    <section class="cart-summary" >
      <div class="cart-summary__details">
        <!-- <div class="cart-summary__row">
            <span class="cart-summary__label">Subtotal</span>
            <span class="cart-summary__value">{{ db.formatCurrency(db.subtotal)}}</span>
          </div>
      
          <div class="cart-summary__row">
            <span class="cart-summary__label">Tax (18%)</span>
            <span class="cart-summary__value">{{ db.formatCurrency(db.tax)}}</span>
          </div> -->

        <div class="cart-summary__total">
          <span class="cart-summary__total-label">Total</span>
          <span class="cart-summary__total-value"
            >{{ db.formatCurrency(db.subtotal)}}</span
          >
        </div>

        <!-- <button on class="cart-summary__button" routerLink="/payment">
          Proceed to Payment
        </button> -->
      </div>

      <app-payment></app-payment>
    </section>

    <!-- ðŸ›’ No Cart Items Found -->
    <div class="empty-cart" *ngIf="!db.cartItems || db.cartItems.length === 0">
      <!-- <img
      src="assets/illustrations/empty-cart.svg"
      alt="Empty Cart"
      class="empty-cart__illustration"
    /> -->
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 500 400">
        <path
          fill="#e0e0e0"
          d="M100 350h300a10 10 0 010 20H100a10 10 0 010-20z"
        />
        <path fill="#f5f5f5" d="M130 320h240l40-180H90l40 180z" />
        <circle cx="180" cy="360" r="20" fill="#9c27b0" />
        <circle cx="320" cy="360" r="20" fill="#9c27b0" />
        <path fill="#d1c4e9" d="M110 140h280v30H110z" />
        <path fill="#b39ddb" d="M130 180h240v10H130z" />
        <path fill="#9575cd" d="M150 200h200v10H150z" />
        <text
          x="150"
          y="270"
          fill="#9e9e9e"
          font-size="18"
          font-family="Arial"
          opacity="0.6"
        >
          Your cart is empty
        </text>
      </svg>

      <h3 class="empty-cart__title">Your cart is empty</h3>
      <p class="empty-cart__text">
        Looks like you havenâ€™t added anything yet. Start exploring our catalog
        to find your next great read!
      </p>
      <ion-button fill="clear" (click)="goToCatalog()">
        Browse Catalog
      </ion-button>
    </div>
  </main>
</ion-content>
